webpackJsonp([11],{U1CF:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("ueeG"),a=o("P9l9"),n=o("rM4U"),i=function(e,t,o){t?Object(n.a)(t)?o():o(new Error("分类目录名称不允许有空格")):o(new Error("请输入分类目录名称"))},s=function(e,t,o){t?Object(n.b)(t)?o():o(new Error("内容只能由英文、下划线、数字组成")):o(new Error("请输入内容"))},l={name:"menuManage",data:function(){return{requestProject:"gic-bizdict",tableData:[],currentPage:1,pageSize:10,totalCount:0,menuTitle:"创建字典分类",dialogVisible:!1,options:[],editCodeBool:!1,createMainBool:!1,menuForm:{categoryName:"",categoryCode:"",typeDict:"",code:"",name:"",aliasName:"",valueContent:"",remark:""},rules:{typeDict:[{required:!0,trigger:"blur",validator:s}],code:[{required:!0,trigger:"blur",validator:s}],name:[{required:!0,trigger:"blur",validator:i}],valueContent:[{required:!0,trigger:"blur",message:"请输入内容"}]},loading:!1,menuType:"",menuId:"",visiblePopover:!1,categoryTreeData:[],defaultProps:{children:"nodeChildren",label:"categoryName"},categorySearchName:"",categoryNameBool:!1,searchInput1:"",searchInput2:"",searchInput3:"",searchCategoryCode:"",searchCategoryName:"",searchVisiblePopover:!1,dialogVisibleLook:!1,lookData:[],defaultPropsLook:{children:"nodeChildren",label:"name"},currentTreeId:""}},mounted:function(){this.init()},watch:{categorySearchName:function(e){this.$refs.tree2.filter(e)},searchCategoryName:function(e){this.$refs.tree3.filter(e)}},methods:{filterNode:function(e,t){return!e||-1!==t.categoryName.indexOf(e)},init:function(){var e=this.$route.query.tabId;this.$emit("showTab",e),this.getDictionaryList()},getDictionaryList:function(){var e=this;this.loading=!0;var t={requestProject:this.requestProject,currentPage:this.currentPage,pageSize:this.pageSize,search:this.searchInput1,typeDict:this.searchInput2,categoryCode:this.searchCategoryCode};Object(a.b)("/gic-bizdict/dict/root",t).then(function(t){var o=t.data.result;if(e.loading=!1,0==o.errorCode){var r=o.result?o.result:[];""!=e.searchInput1&&""!=e.searchInput2&&""!=e.searchCategoryCode?e.tableData=r:(e.tableData=e.addMenuPara(r),e.tableData.forEach(function(e){e.firstLevel=!0})),e.totalCount=o.totalCount}else e.$message.error(o.message)}).catch(function(e){console.log(e)})},loadNextList:function(e,t,o){var r=this,n={requestProject:this.requestProject,code:e.code,categoryCode:e.categoryCode},i=[];Object(a.b)("/gic-bizdict/dict/next",n).then(function(e){var t=e.data;if(0==t.errorCode){var a=t.result?t.result:[];i=r.addMenuPara(a),o(i)}else r.$message.error(t.message)}).catch(function(e){console.log(e)})},searchList:function(){this.currentPage=1,this.getDictionaryList()},handleCurrentChange:function(e){this.currentPage=e,this.getDictionaryList()},handleSizeChange:function(e){this.pageSize=e,this.getDictionaryList()},addMenuPara:function(e){return e.forEach(function(t){t.numBool=!0,t.total=e.length,t.hasChildren=t.nextCount>0,t.oldSort=t.indexSort}),e},getCategoryList:function(){var e=this,t={requestProject:this.requestProject};Object(a.b)("/gic-bizdict/category/all",t).then(function(t){var o=t.data;e.loading=!1,0==o.errorCode?e.categoryTreeData=o.result?o.result:[]:e.$message.error(o.message)}).catch(function(e){console.log(e)})},changeNum:function(e){e.numBool=!1},blurNumInput:function(e){e.numBool=!0,e.indexSort>e.total||e.indexSort<1?e.indexSort=e.oldSort:this.sortMenu(e)},sortMenu:function(e){var t=this,o={requestProject:this.requestProject,sortDict:!0,sort:e.indexSort,categoryCode:e.categoryCode};Object(a.d)("/gic-bizdict/dict/"+e.code,o).then(function(e){var o=e.data;0==o.errorCode?(t.getDictionaryList(),t.$message.success("排序成功")):t.$message.error(o.message)}).catch(function(e){console.log(e)})},keyupInput:function(e){(e.indexSort>e.total||e.indexSort<1)&&(e.indexSort="")},lookDictionay:function(e){var t=this;this.dialogVisibleLook=!0;var o={requestProject:this.requestProject,code:e.code,categoryCode:e.categoryCode};Object(a.b)("/gic-bizdict/dict/tree",o).then(function(o){var r=o.data;t.loading=!1,0==r.errorCode?(t.lookData=r.result?r.result:[],t.currentTreeId=e.id,t.$nextTick(function(e){t.$refs.lookTree.setCurrentKey(t.currentTreeId)})):t.$message.error(r.message)}).catch(function(e){console.log(e)})},lookHandleNodeClick:function(){this.$refs.lookTree.setCurrentKey(this.currentTreeId)},delMenu:function(e,t,o){var r=this;this.$confirm("是否要删除选中的字典?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={requestProject:r.requestProject,categoryCode:t.categoryCode};Object(a.a)("/gic-bizdict/dict/"+t.code,e).then(function(e){var t=e.data;0==t.errorCode?(r.getDictionaryList(),r.$message.success("删除成功")):r.$message.error(t.message)})}).catch(function(e){console.log(e)})},handleNodeClick:function(e){this.menuForm.categoryName=e.categoryName,this.menuForm.categoryCode=e.code,this.categorySearchName="",this.visiblePopover=!1,this.categoryNameBool=!1},handleNodeClick2:function(e){this.searchInput3=e.categoryName,this.searchCategoryCode=e.code,this.searchCategoryName="",this.searchVisiblePopover=!1,this.searchList()},delItem:function(){this.searchInput3="",this.searchCategoryCode="",this.currentPage=1,this.getDictionaryList()},editMenu:function(e){this.getCategoryList(),this.menuTitle="编辑字典",this.menuType="edit",this.dialogVisible=!0,this.editCodeBool=!0,this.createMainBool=!0,this.menuId=e.id,this.menuForm={categoryName:e.categoryName,categoryCode:e.categoryCode,typeDict:e.typeDict,code:e.code,name:e.name,aliasName:e.aliasName,valueContent:e.valueContent,remark:e.remark,parentCode:e.parentCode}},toCreateMenu:function(e,t){this.dialogVisible=!0,this.editCodeBool=!1,this.menuId="",this.menuType="add",this.getCategoryList(),this.$refs.menuForm&&this.$refs.menuForm.resetFields(),"main"==e?(this.menuTitle="创建字典",this.menuForm.parentCode="",this.createMainBool=!1,this.menuForm.categoryName="",this.menuForm.categoryCode="",this.categorySearchName=""):"child"==e&&(this.menuForm.parentCode=t.code,this.menuTitle="创建子节点",this.createMainBool=!0,this.menuForm.categoryName=t.categoryName,this.menuForm.categoryCode=t.categoryCode),this.menuForm.typeDict="",this.menuForm.name="",this.menuForm.code="",this.menuForm.aliasName="",this.menuForm.valueContent="",this.menuForm.remark=""},cancelCreate:function(){this.dialogVisible=!1,this.$refs.menuForm.clearValidate()},sureCreate:function(e){var t=this;this.$refs[e].validate(function(e){if(t.categoryNameBool=""==t.menuForm.categoryName,!e||t.categoryNameBool)return console.log("error submit!!"),!1;var o={requestProject:t.requestProject,parentCode:t.menuForm.parentCode,categoryCode:t.menuForm.categoryCode,typeDict:t.menuForm.typeDict,code:t.menuForm.code,name:t.menuForm.name,valueContent:t.menuForm.valueContent,aliasName:t.menuForm.aliasName,remark:t.menuForm.remark};"add"==t.menuType?Object(a.c)("/gic-bizdict/dict",o).then(function(e){var o=e.data;0==o.errorCode?(t.dialogVisible=!1,t.searchInput1="",t.searchInput2="",t.searchInput3="",t.searchCategoryCode="",t.searchCategoryName="",t.currentPage=1,t.getDictionaryList(),t.$message.success("保存成功")):t.$message.error(o.message)}).catch(function(e){console.log(e)}):"edit"==t.menuType&&Object(a.d)("/gic-bizdict/dict/"+t.menuForm.code,o).then(function(e){var o=e.data;0==o.errorCode?(t.dialogVisible=!1,t.getDictionaryList(),t.$message.success("保存成功")):t.$message.error(o.message)}).catch(function(e){console.log(e)})})}},components:{ywInput:r.a}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"my-right-content"},[r("div",{staticClass:"create-btn clearfix"},[r("el-input",{staticClass:"search-input",attrs:{clearable:"",placeholder:"请输入名称、内容、字典编码","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchList(t)}},model:{value:e.searchInput1,callback:function(t){e.searchInput1=t},expression:"searchInput1"}}),e._v(" "),r("el-input",{staticClass:"search-input",attrs:{clearable:"",placeholder:"请输入字典类型","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchList(t)}},model:{value:e.searchInput2,callback:function(t){e.searchInput2=t},expression:"searchInput2"}}),e._v(" "),r("el-popover",{attrs:{placement:"bottom",width:"219",trigger:"click"},model:{value:e.searchVisiblePopover,callback:function(t){e.searchVisiblePopover=t},expression:"searchVisiblePopover"}},[r("el-input",{attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",clearable:""},model:{value:e.searchCategoryName,callback:function(t){e.searchCategoryName=t},expression:"searchCategoryName"}}),e._v(" "),r("el-tree",{ref:"tree3",staticClass:"my-tree-wrap",attrs:{"default-expand-all":"","expand-on-click-node":!1,data:e.categoryTreeData,props:e.defaultProps,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick2}}),e._v(" "),r("div",{staticClass:"el-input dm-store__reference search-input",attrs:{slot:"reference"},on:{click:e.getCategoryList},slot:"reference"},[r("div",{staticClass:"el-input__inner dm-store__inputtag"},[""!=e.searchInput3?r("el-tag",{attrs:{size:"small",closable:""},on:{close:e.delItem}},[e._v(e._s(e.searchInput3))]):r("span",{staticClass:"gray-color dm-store__inputtag--tips"},[e._v("请选择类目")])],1)])],1),e._v(" "),r("el-button",{staticClass:"fr",attrs:{type:"primary"},on:{click:function(t){return e.toCreateMenu("main")}}},[e._v("创建字典类目")])],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"my-table-wrap table-no-line-wrap",attrs:{data:e.tableData,"row-key":"id",lazy:"",load:e.loadNextList}},[r("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":"","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.indexSort>-1?r("div",{staticClass:"menu-name-wrap ",class:{"my-name-wrap":t.row.firstLevel,"my-no-child":t.row.nextCount>0}},[t.row.numBool?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"排序",placement:"top"}},[r("span",{on:{click:function(o){return e.changeNum(t.row)}}},[e._v(e._s(t.row.indexSort))])]):r("el-input",{directives:[{name:"focus",rawName:"v-focus",value:!t.row.numBool,expression:"!scoped.row.numBool"}],staticClass:"num-input-wrap",attrs:{type:"number"},on:{blur:function(o){return e.blurNumInput(t.row)}},nativeOn:{keyup:function(o){return e.keyupInput(t.row)}},model:{value:t.row.indexSort,callback:function(o){e.$set(t.row,"indexSort","string"==typeof o?o.trim():o)},expression:"scoped.row.indexSort"}}),e._v("\n          "+e._s(t.row.name)+"\n        ")],1):r("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"typeDict",label:"字典类型","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"code",label:"字典编码","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"parentCode",label:"父级编码","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.parentCode?t.row.parentCode:"--"))]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"categoryName",label:"类目名称","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"categoryCode",label:"类目code","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"valueContent",label:"内容","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"opr",label:"操作",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.indexSort<0,expression:"scoped.row.indexSort < 0"}],attrs:{type:"text"},on:{click:function(o){return e.lookDictionay(t.row)}}},[e._v("查看")]),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(o){return e.editMenu(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(o){return e.toCreateMenu("child",t.row)}}},[e._v("创建子节点")]),e._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.nextCount<1,expression:"scoped.row.nextCount < 1"}],attrs:{type:"text"},on:{click:function(o){return e.delMenu(t,t.row,t.$index)}}},[e._v("删除")])]}}])}),e._v(" "),r("template",{slot:"empty"},[r("div",{staticClass:"no-data-wrap"},[r("div",{staticClass:"no-data-icon"},[r("img",{attrs:{src:o("8Td+"),alt:""}})]),e._v(" "),r("p",[e._v("暂无数据")])])])],2),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.totalCount>0,expression:"totalCount > 0"}],staticClass:"pagination"},[r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{title:e.menuTitle,visible:e.dialogVisible,width:"500px","before-close":e.cancelCreate},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"menuForm",attrs:{model:e.menuForm,rules:e.rules,"label-width":"140px"}},[r("el-form-item",{staticClass:"is-required",class:{"is-error":e.categoryNameBool,"is-success":!e.categoryNameBool&&""!=e.menuForm.categoryName},attrs:{label:"字典分类目录名称",prop:"categoryName"}},[e.createMainBool?r("el-input",{attrs:{disabled:e.createMainBool,placeholder:"请选择字典分类目录名称"},model:{value:e.menuForm.categoryName,callback:function(t){e.$set(e.menuForm,"categoryName",t)},expression:"menuForm.categoryName"}}):r("el-popover",{attrs:{placement:"bottom",width:"294",trigger:"click"},model:{value:e.visiblePopover,callback:function(t){e.visiblePopover=t},expression:"visiblePopover"}},[r("el-input",{attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",clearable:""},model:{value:e.categorySearchName,callback:function(t){e.categorySearchName=t},expression:"categorySearchName"}}),e._v(" "),r("el-tree",{ref:"tree2",staticClass:"my-tree-wrap",attrs:{"default-expand-all":"","expand-on-click-node":!1,data:e.categoryTreeData,props:e.defaultProps,"filter-node-method":e.filterNode},on:{"node-click":e.handleNodeClick}}),e._v(" "),r("el-input",{attrs:{slot:"reference",readonly:"",placeholder:"请选择字典分类目录名称"},slot:"reference",model:{value:e.menuForm.categoryName,callback:function(t){e.$set(e.menuForm,"categoryName",t)},expression:"menuForm.categoryName"}})],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.categoryNameBool&&""==e.menuForm.categoryName,expression:"categoryNameBool && menuForm.categoryName == ''"}],staticClass:"el-form-item__error"},[e._v("请选择字典分类目录名称")])],1),e._v(" "),r("el-form-item",{attrs:{label:"字典类型",prop:"typeDict"}},[r("yw-input",{attrs:{byteType:0,maxlength:32,placeholder:"英文、下划线、数字组成，最多32字"},model:{value:e.menuForm.typeDict,callback:function(t){e.$set(e.menuForm,"typeDict",t)},expression:"menuForm.typeDict"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"字典编码",prop:"code"}},[r("yw-input",{attrs:{disabled:e.editCodeBool,byteType:0,maxlength:32,placeholder:"英文、下划线、数字组成，最多32字"},model:{value:e.menuForm.code,callback:function(t){e.$set(e.menuForm,"code",t)},expression:"menuForm.code"}})],1),e._v(" "),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.menuForm.parentCode,expression:"menuForm.parentCode"}],attrs:{label:"父级编码"}},[r("yw-input",{attrs:{disabled:"",byteType:0,maxlength:32},model:{value:e.menuForm.parentCode,callback:function(t){e.$set(e.menuForm,"parentCode",t)},expression:"menuForm.parentCode"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("yw-input",{attrs:{byteType:0,maxlength:20,placeholder:"最多20字"},model:{value:e.menuForm.name,callback:function(t){e.$set(e.menuForm,"name",t)},expression:"menuForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"别名"}},[r("yw-input",{attrs:{byteType:0,maxlength:20,placeholder:"最多20字"},model:{value:e.menuForm.aliasName,callback:function(t){e.$set(e.menuForm,"aliasName",t)},expression:"menuForm.aliasName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"内容",prop:"valueContent"}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.menuForm.valueContent,callback:function(t){e.$set(e.menuForm,"valueContent",t)},expression:"menuForm.valueContent"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"说明"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.menuForm.remark,callback:function(t){e.$set(e.menuForm,"remark",t)},expression:"menuForm.remark"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelCreate}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sureCreate("menuForm")}}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{staticClass:"look-tree-dialog-wrap",attrs:{title:"查看",visible:e.dialogVisibleLook,width:"450px"},on:{"update:visible":function(t){e.dialogVisibleLook=t}}},[r("el-tree",{ref:"lookTree",staticClass:"look-tree-wrap",attrs:{data:e.lookData,props:e.defaultPropsLook,"default-expand-all":"","node-key":"id","highlight-current":"","expand-on-click-node":!1},on:{"node-click":e.lookHandleNodeClick}}),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisibleLook=!1}}},[e._v("知道了")])],1)],1)],1)},staticRenderFns:[]};var u=o("C7Lr")(l,c,!1,function(e){o("z/xy")},"data-v-9f0f5e6a",null);t.default=u.exports},"z/xy":function(e,t){}});
//# sourceMappingURL=11.c9c8288a35dbf9607bea.1560498375860.js.map