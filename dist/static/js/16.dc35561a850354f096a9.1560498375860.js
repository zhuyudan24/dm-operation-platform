webpackJsonp([16],{LMJ6:function(e,t){},RLqh:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("ueeG"),r=o("P9l9"),a=o("rM4U"),i=function(e,t,o){t?Object(a.a)(t)?o():o(new Error("菜单名称不允许有空格")):o(new Error("请输入菜单名称"))},l=function(e,t,o){t?Object(a.a)(t)?o():o(new Error("URI不允许有空格")):o(new Error("请输入URI"))},u=function(e,t,o){t?Object(a.b)(t)?o():o(new Error("菜单编码只能由英文、下划线、数字组成")):o(new Error("请输入菜单编码"))},s={name:"menuManage",data:function(){return{requestProject:"gic-authcenter",tableData:[],menuTitle:"创建菜单",dialogVisible:!1,options:[],editCodeBool:!1,menuForm:{applyName:"",menuName:"",menuCode:"",parentCode:"",URI:"",openStyle:0,icon:"",isShow:1},rules:{applyName:[{required:!0,trigger:"change",message:"请选择应用模块名称"}],menuName:[{required:!0,trigger:"blur",validator:i}],menuCode:[{required:!0,trigger:"blur",validator:u}],URI:[{required:!0,trigger:"blur",validator:l}],openStyle:[{required:!0,trigger:"change",message:"请选择打开方式"}],isShow:[{required:!0,trigger:"change",message:"请选择是否显示"}]},loading:!1,menuType:"",menuId:""}},mounted:function(){this.init()},methods:{init:function(){var e=this.$route.query.tabId;this.$emit("showTab",e),this.getMenuList(),this.getApplyList()},getMenuList:function(){var e=this;this.loading=!0;var t={requestProject:this.requestProject};Object(r.b)("/gic-authcenter/menu/tree",t).then(function(t){var o=t.data;if(e.loading=!1,0==o.errorCode){var n=o.result?o.result:[];e.tableData=e.addMenuPara(n)}else e.$message.error(o.message)}).catch(function(e){console.log(e)})},getApplyList:function(){var e=this,t={requestProject:this.requestProject};Object(r.b)("/gic-authcenter/app",t).then(function(t){var o=t.data;0==o.errorCode?e.options=o.result?o.result:[]:e.$message.error(o.message)}).catch(function(e){console.log(e)})},addMenuPara:function(e){var t=this;return e.forEach(function(o){o.numBool=!0,o.children=o.nodeChildren?o.nodeChildren:[],o.total=e.length,o.oldSort=o.indexSort,o.children.length>0&&t.addMenuPara(o.children)}),e},changeNum:function(e){e.numBool=!1},blurNumInput:function(e){e.numBool=!0,e.indexSort>e.total||e.indexSort<1?e.indexSort=e.oldSort:this.sortMenu(e)},sortMenu:function(e){var t=this,o={requestProject:this.requestProject,sortMenu:!0,sort:e.indexSort};Object(r.d)("/gic-authcenter/menu/tree/"+e.code,o).then(function(e){var o=e.data;0==o.errorCode?(t.getMenuList(),t.$message.success("排序成功")):t.$message.error(o.message)}).catch(function(e){console.log(e)})},keyupInput:function(e){(e.indexSort>e.total||e.indexSort<1)&&(e.indexSort="")},delMenu:function(e,t,o){var n=this;this.$confirm("是否要删除选中的菜单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={requestProject:n.requestProject};Object(r.a)("/gic-authcenter/menu/tree/"+t.code,e).then(function(e){var t=e.data;0==t.errorCode?(n.getMenuList(),n.$message.success("删除成功")):n.$message.error(t.message)})}).catch(function(e){console.log(e)})},editMenu:function(e){this.menuTitle="编辑菜单",this.menuType="edit",this.dialogVisible=!0,this.editCodeBool=!0,this.menuId=e.id,this.menuForm={applyName:e.appId,menuName:e.menuName,menuCode:e.code,parentCode:e.parentCode,URI:e.uri,openStyle:e.target,icon:e.iconUrl,isShow:e.isShow}},toCreateMenu:function(e,t){this.dialogVisible=!0,this.editCodeBool=!1,this.menuId="",this.menuType="add",this.$refs.menuForm&&this.$refs.menuForm.resetFields(),"main"==e?(this.menuTitle="创建菜单",this.menuForm.parentCode=""):"child"==e&&(this.menuForm.parentCode=t.code,this.menuTitle="创建子菜单"),this.menuForm.applyName="",this.menuForm.menuName="",this.menuForm.menuCode="",this.menuForm.URI="",this.menuForm.openStyle=0,this.menuForm.icon="",this.menuForm.isShow=1},cancelCreate:function(){this.dialogVisible=!1,this.$refs.menuForm.clearValidate()},sureCreate:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var o={requestProject:t.requestProject,menuName:t.menuForm.menuName,code:t.menuForm.menuCode,uri:t.menuForm.URI,appId:t.menuForm.applyName,target:t.menuForm.openStyle,iconUrl:t.menuForm.icon,isShow:t.menuForm.isShow,parentCode:t.menuForm.parentCode,id:t.menuId};"add"==t.menuType?(delete o.id,Object(r.c)("/gic-authcenter/menu/tree",o).then(function(e){var o=e.data;0==o.errorCode?(t.dialogVisible=!1,t.getMenuList(),t.$message.success("保存成功")):t.$message.error(o.message)}).catch(function(e){console.log(e)})):"edit"==t.menuType&&Object(r.d)("/gic-authcenter/menu/tree/"+t.menuForm.menuCode,o).then(function(e){var o=e.data;0==o.errorCode?(t.dialogVisible=!1,t.getMenuList(),t.$message.success("保存成功")):t.$message.error(o.message)}).catch(function(e){console.log(e)})})}},components:{ywInput:n.a}},m={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"my-right-content"},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],staticClass:"create-btn"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.toCreateMenu("main")}}},[e._v("创建菜单")])],1),e._v(" "),e.tableData.length>0?o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-no-line-wrap my-table-wrap",attrs:{data:e.tableData,"row-key":"id"}},[o("el-table-column",{attrs:{prop:"menuName",label:"菜单名称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",{staticClass:"menu-name-wrap ",class:{"my-name-wrap":t.row.firstLevel,"my-no-child":t.row.nodeChildren&&t.row.nodeChildren.length>0}},[t.row.numBool?o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"排序",placement:"top"}},[o("span",{on:{click:function(o){return e.changeNum(t.row)}}},[e._v(e._s(t.row.indexSort))])]):o("el-input",{directives:[{name:"focus",rawName:"v-focus",value:!t.row.numBool,expression:"!scoped.row.numBool"}],staticClass:"num-input-wrap",attrs:{type:"number"},on:{blur:function(o){return e.blurNumInput(t.row)}},nativeOn:{keyup:function(o){return e.keyupInput(t.row)}},model:{value:t.row.indexSort,callback:function(o){e.$set(t.row,"indexSort","string"==typeof o?o.trim():o)},expression:"scoped.row.indexSort"}}),e._v("\n          "+e._s(t.row.menuName)+"\n        ")],1)]}}],null,!1,2271772701)}),e._v(" "),o("el-table-column",{attrs:{prop:"code",label:"菜单编码","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"parentCode",label:"父级编码","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.parentCode?t.row.parentCode:"--"))]}}],null,!1,155386620)}),e._v(" "),o("el-table-column",{attrs:{prop:"appName",label:"应用模块名称","show-overflow-tooltip":""}}),e._v(" "),o("el-table-column",{attrs:{prop:"opr",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.editMenu(t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.toCreateMenu("child",t.row)}}},[e._v("创建子菜单")]),e._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.children.length<1,expression:"scoped.row.children.length < 1"}],attrs:{type:"text"},on:{click:function(o){return e.delMenu(t,t.row,t.$index)}}},[e._v("删除")])]}}],null,!1,1652696060)})],1):o("div",{staticClass:"my-no-data-wrap"},[o("i",{staticClass:"iconfont iconkong"}),e._v(" "),o("h3",[e._v("现在还没有菜单哦~")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.toCreateMenu("main")}}},[e._v("去创建菜单")])],1),e._v(" "),o("el-dialog",{attrs:{title:e.menuTitle,visible:e.dialogVisible,width:"425px","before-close":e.cancelCreate},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("el-form",{ref:"menuForm",attrs:{model:e.menuForm,rules:e.rules,"label-width":"110px"}},[o("el-form-item",{attrs:{label:"应用模块名称",prop:"applyName"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择应用模块名称"},model:{value:e.menuForm.applyName,callback:function(t){e.$set(e.menuForm,"applyName",t)},expression:"menuForm.applyName"}},e._l(e.options,function(e){return o("el-option",{key:e.id,attrs:{label:e.appName,value:e.id}})}),1)],1),e._v(" "),o("el-form-item",{attrs:{label:"菜单名称",prop:"menuName"}},[o("yw-input",{attrs:{byteType:0,maxlength:20,placeholder:"输入名称，最多20字"},model:{value:e.menuForm.menuName,callback:function(t){e.$set(e.menuForm,"menuName",t)},expression:"menuForm.menuName"}})],1),e._v(" "),o("el-form-item",{directives:[{name:"show",rawName:"v-show",value:""!=e.menuForm.parentCode,expression:"menuForm.parentCode != ''"}],attrs:{label:"父菜单编码",prop:"parentCode"}},[o("yw-input",{attrs:{disabled:"",byteType:0,maxlength:32},model:{value:e.menuForm.parentCode,callback:function(t){e.$set(e.menuForm,"parentCode",t)},expression:"menuForm.parentCode"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"菜单编码",prop:"menuCode"}},[o("yw-input",{attrs:{disabled:e.editCodeBool,byteType:0,maxlength:32,placeholder:"英文、下划线、数字组成，最多32字"},model:{value:e.menuForm.menuCode,callback:function(t){e.$set(e.menuForm,"menuCode",t)},expression:"menuForm.menuCode"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"URI",prop:"URI"}},[o("yw-input",{attrs:{byteType:0,maxlength:50,placeholder:"长度限制50个字，不能有空格"},model:{value:e.menuForm.URI,callback:function(t){e.$set(e.menuForm,"URI",t)},expression:"menuForm.URI"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"打开方式",prop:"openStyle"}},[o("el-radio-group",{model:{value:e.menuForm.openStyle,callback:function(t){e.$set(e.menuForm,"openStyle",t)},expression:"menuForm.openStyle"}},[o("el-radio",{attrs:{label:0}},[e._v("当前页")]),e._v(" "),o("el-radio",{attrs:{label:1}},[e._v("新开页")])],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"图标"}},[o("yw-input",{attrs:{byteType:0,maxlength:64,placeholder:"长度限制64个字，不能有空格"},model:{value:e.menuForm.icon,callback:function(t){e.$set(e.menuForm,"icon",t)},expression:"menuForm.icon"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"是否显示",prop:"isShow"}},[o("el-radio-group",{model:{value:e.menuForm.isShow,callback:function(t){e.$set(e.menuForm,"isShow",t)},expression:"menuForm.isShow"}},[o("el-radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),o("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.cancelCreate}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sureCreate("menuForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=o("C7Lr")(s,m,!1,function(e){o("LMJ6")},"data-v-22b9d6c8",null);t.default=c.exports}});
//# sourceMappingURL=16.dc35561a850354f096a9.1560498375860.js.map