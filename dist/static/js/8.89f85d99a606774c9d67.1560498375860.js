webpackJsonp([8],{HgHF:function(e,r){},JXTs:function(e,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=o("P9l9"),n={name:"ywHeader",props:{linkType:{type:String,default:""}},data:function(){return{requestProject:"gic-authcenter",dialogPawVisible:!1,pawForm:{oldPaw:"",newPaw:"",surePaw:""},rules:{oldPaw:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPaw:[{required:!0,message:"请输入新密码",trigger:"blur"}],surePaw:[{required:!0,message:"请输入确认密码",trigger:"blur"}]},userFormVisible:!1,userInfoForm:{realName:"",gender:0,clerkCode:"",phoneNumber:"",positionName:""},userFormRules:{realName:[{required:!0,message:"请输入姓名",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],clerkCode:[{required:!0,message:"请输入员工代码",trigger:"blur"}],phoneNumber:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"手机号码格式不正确"}],positionName:[{required:!0,message:"请输入职位",trigger:"blur"}]},isIndex:!1,entranceType:"",loginName:"",menuAllCode:[],isLogBool:!0,isAuthorityBool:!0,authorityUrl:""}},watch:{linkType:function(e){this.entranceType=e}},mounted:function(){this.getUserInfo()},methods:{getUserInfo:function(){var e=this,r={requestProject:this.requestProject};Object(t.b)("/gic-authcenter/loginuser",r).then(function(r){var o=r.data;if(0==o.errorCode){var t=o.result;e.userInfoForm.realName=t.realName,e.userInfoForm.gender=parseInt(t.sex),e.userInfoForm.clerkCode=t.employeeNumber,e.userInfoForm.phoneNumber=t.userMobile,e.userInfoForm.positionName=t.position,e.loginName=t.loginName;var n=t.menuTree?t.menuTree:[],s=e.getMenuTreeCode(n);e.isAuthorityBool=s.indexOf("authz_manage")>-1,e.isLogBool=s.indexOf("system_log")>-1,n.forEach(function(r){"authcenter"==r.code&&r.nodeChildren&&r.nodeChildren.length>0&&r.nodeChildren.forEach(function(r){"authz_manage"==r.code&&(e.authorityUrl=r.nodeChildren[0].nodeChildren?r.nodeChildren[0].nodeChildren[0].uri:r.nodeChildren[0].uri)})})}else e.$message.error(o.message)}).catch(function(e){console.log(e)})},getMenuTreeCode:function(e){var r=this;return e.forEach(function(e){r.menuAllCode.push(e.code),e.nodeChildren&&e.nodeChildren.length>0&&r.getMenuTreeCode(e.nodeChildren)}),this.menuAllCode},toModifyUser:function(){this.userFormVisible=!0},cancelModUserInfo:function(e){this.userFormVisible=!1,this.$refs[e].clearValidate()},confirmModUserInfo:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var o={requestProject:r.requestProject,realName:r.userInfoForm.realName,sex:r.userInfoForm.gender,userMobile:r.userInfoForm.phoneNumber,position:r.userInfoForm.positionName};Object(t.d)("/gic-authcenter/loginuser/"+r.loginName,o).then(function(e){var o=e.data;0==o.errorCode?(r.userFormVisible=!1,r.$message.success("修改成功")):r.$message.error(o.message)}).catch(function(e){console.log(e)})})},toModifyPaw:function(){this.dialogPawVisible=!0,this.pawForm.oldPaw="",this.pawForm.newPaw="",this.pawForm.surePaw=""},toModifyPawCancel:function(e){this.dialogPawVisible=!1,this.$refs[e].clearValidate()},toModifyPawSure:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var o={oldPassword:r.pawForm.oldPaw,newPassword:r.pawForm.newPaw};return r.pawForm.oldPaw.trim()&&r.pawForm.newPaw.trim()&&r.pawForm.surePaw.trim()?r.pawForm.newPaw.trim()!=r.pawForm.surePaw.trim()?(r.$message.error("两次密码输入不一致!"),!1):void Object(t.c)("/gic-authcenter/password",o).then(function(e){var o=e.data;0==o.errorCode?(r.dialogPawVisible=!1,r.$message.success("修改成功"),Object(t.b)("/gic-authcenter/logout",{}).then(function(e){var o=e.data;0==o.errorCode?window.location.href=window.location.origin+"/operation-platform/#/":r.$message.error(o.message)}).catch(function(e){console.log(e)})):r.$message.error(o.message)}).catch(function(e){console.log(e)}):(r.$message.error("请输入密码"),!1)})},toLoginOut:function(){var e=this;this.$confirm("确认退出吗?","提示",{type:"warning"}).then(function(){Object(t.b)("/gic-authcenter/logout",{}).then(function(r){var o=r.data;0==o.errorCode?(e.$message.success("退出成功"),window.location.href=window.location.origin+"/operation-platform/#/"):e.$message.error(o.message)}).catch(function(e){console.log(e)})}).catch(function(){})},entranceAuthority:function(e){this.entranceType=e,this.$router.push({path:this.authorityUrl,query:{code:"authz_manage"}})},entranceLog:function(e){this.entranceType=e,this.$router.push("/log")},backIndex:function(){this.$router.push("/index")}}},s={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"header clearfix"},[t("div",{staticClass:"fl logo",on:{click:e.backIndex}},[t("img",{attrs:{src:o("OLQK"),alt:""}})]),e._v(" "),t("div",{staticClass:"fr login-user-info"},[t("div",{staticClass:"user-info-wrap",class:{"index-user-info":e.isIndex}},[t("div",{staticClass:"other-operation"},[t("span",{directives:[{name:"show",rawName:"v-show",value:e.isAuthorityBool,expression:"isAuthorityBool"}],class:{on:"authority"==e.entranceType},on:{click:function(r){return e.entranceAuthority("authority")}}},[e._v("权限管理")]),e._v(" "),t("b",{directives:[{name:"show",rawName:"v-show",value:e.isAuthorityBool,expression:"isAuthorityBool"}]},[e._v("|")]),e._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:e.isLogBool,expression:"isLogBool"}],class:{on:"log"==e.entranceType},on:{click:function(r){return e.entranceLog("log")}}},[e._v("操作日志")]),e._v(" "),t("b",{directives:[{name:"show",rawName:"v-show",value:e.isLogBool,expression:"isLogBool"}]},[e._v("|")])]),e._v(" "),t("el-popover",{staticStyle:{"min-width":"95px"},attrs:{placement:"bottom",title:"",width:"74",trigger:"hover","popper-class":e.isIndex?"user-header-pop":"com-user-header-pop"}},[t("ul",{staticClass:"navsuerwrap"},[t("li",{staticClass:"useritem",on:{click:e.toModifyUser}},[t("span",{staticClass:"usertext"},[e._v("账号信息")])]),e._v(" "),t("li",{staticClass:"useritem",on:{click:e.toModifyPaw}},[t("span",{staticClass:"usertext"},[e._v("修改密码")])]),e._v(" "),t("li",{staticClass:"useritem loginout",on:{click:e.toLoginOut}},[t("span",{staticClass:"usertext"},[e._v("退出登录")])])]),e._v(" "),t("span",{staticClass:"navusername",attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(e.userInfoForm.realName)),t("i",{staticClass:"el-icon-arrow-down arrowico"})])])],1)]),e._v(" "),t("el-dialog",{staticClass:"user-form-dialog",attrs:{title:"账户信息",visible:e.userFormVisible,width:"425px"},on:{"update:visible":function(r){e.userFormVisible=r}}},[t("el-form",{ref:"userForm",attrs:{model:e.userInfoForm,rules:e.userFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[t("el-input",{model:{value:e.userInfoForm.realName,callback:function(r){e.$set(e.userInfoForm,"realName",r)},expression:"userInfoForm.realName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"性别",prop:"gender"}},[t("el-radio-group",{model:{value:e.userInfoForm.gender,callback:function(r){e.$set(e.userInfoForm,"gender",r)},expression:"userInfoForm.gender"}},[t("el-radio",{attrs:{label:1}},[e._v("男")]),e._v(" "),t("el-radio",{attrs:{label:0}},[e._v("女")])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"工号",prop:"clerkCode"}},[t("el-input",{attrs:{disabled:""},model:{value:e.userInfoForm.clerkCode,callback:function(r){e.$set(e.userInfoForm,"clerkCode",r)},expression:"userInfoForm.clerkCode"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"手机号码",prop:"phoneNumber"}},[t("el-input",{attrs:{type:"text",maxlength:11},model:{value:e.userInfoForm.phoneNumber,callback:function(r){e.$set(e.userInfoForm,"phoneNumber",r)},expression:"userInfoForm.phoneNumber"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"职位",prop:"positionName"}},[t("el-input",{model:{value:e.userInfoForm.positionName,callback:function(r){e.$set(e.userInfoForm,"positionName",r)},expression:"userInfoForm.positionName"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(r){return e.cancelModUserInfo("userForm")}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.confirmModUserInfo("userForm")}}},[e._v("确 定")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"修改密码",visible:e.dialogPawVisible,width:"385px"},on:{"update:visible":function(r){e.dialogPawVisible=r}}},[t("el-form",{ref:"pawForm",attrs:{model:e.pawForm,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"旧密码",prop:"oldPaw"}},[t("el-input",{model:{value:e.pawForm.oldPaw,callback:function(r){e.$set(e.pawForm,"oldPaw",r)},expression:"pawForm.oldPaw"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"新密码",prop:"newPaw"}},[t("el-input",{model:{value:e.pawForm.newPaw,callback:function(r){e.$set(e.pawForm,"newPaw",r)},expression:"pawForm.newPaw"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"确认密码",prop:"surePaw"}},[t("el-input",{model:{value:e.pawForm.surePaw,callback:function(r){e.$set(e.pawForm,"surePaw",r)},expression:"pawForm.surePaw"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(r){return e.toModifyPawCancel("pawForm")}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.toModifyPawSure("pawForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var a={name:"index",data:function(){return{linkType:""}},methods:{getLinkType:function(e){this.linkType=e}},components:{ywHeader:o("C7Lr")(n,s,!1,function(e){o("Nzpn")},"data-v-7d10d1f5",null).exports}},i={render:function(){var e=this.$createElement,r=this._self._c||e;return r("div",{staticClass:"my-content-wrap"},[r("yw-header",{attrs:{linkType:this.linkType}}),this._v(" "),r("div",{staticClass:"my-content-content"},[r("router-view",{on:{getLinkType:this.getLinkType}})],1)],1)},staticRenderFns:[]};var l=o("C7Lr")(a,i,!1,function(e){o("HgHF")},"data-v-0f0d9992",null);r.default=l.exports},Nzpn:function(e,r){}});
//# sourceMappingURL=8.89f85d99a606774c9d67.1560498375860.js.map