webpackJsonp([14],{GGLC:function(e,t){},saP7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("ueeG"),n=a("P9l9"),o=a("rM4U"),i=function(e,t,a){t?Object(o.a)(t)?a():a(new Error("权限名称不允许有空格")):a(new Error("请输入权限名称"))},s=function(e,t,a){t?Object(o.b)(t)?a():a(new Error("权限code只能由英文、下划线、数字组成")):a(new Error("请输入权限code"))},l={name:"authorityList",data:function(){return{requestProject:"gic-authcenter",searchInput:"",tableData:[],currentPage:1,pageSize:10,totalCount:0,loading:!1,dialogVisible:!1,menuTitle:"新增权限",editCodeType:"add",menuForm:{menuName:"",menuCode:"",detail:""},rules:{menuName:[{required:!0,trigger:"blur",validator:i}],menuCode:[{required:!0,trigger:"blur",validator:s}]}}},mounted:function(){this.init()},methods:{init:function(){var e=this.$route.query.tabId;this.$emit("showTab",e),this.getList()},getList:function(){var e=this;this.loading=!0;var t={requestProject:this.requestProject,currentPage:this.currentPage,pageSize:this.pageSize,search:this.searchInput};Object(n.b)("/gic-authcenter/permission",t).then(function(t){var a=t.data;e.loading=!1,0==a.errorCode?(e.tableData=a.result?a.result:[],e.totalCount=a.totalCount):e.$message.error(a.message)}).catch(function(e){console.log(e)})},handleCurrentChange:function(e){this.currentPage=e,this.getList()},handleSizeChange:function(e){this.pageSize=e,this.getList()},searchList:function(){this.currentPage=1,this.getList()},delAuthority:function(e,t){var a=this;this.$confirm("是否要删除选中的权限?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var r={requestProject:a.requestProject};Object(n.a)("/gic-authcenter/permission/"+e.permissionCode,r).then(function(e){var r=e.data;0==r.errorCode?(a.totalCount--,a.tableData.splice(t,1),0==a.tableData.length&&(a.currentPage>1?(a.currentPage--,a.getList()):a.totalCount>0&&a.getList()),a.$message.success("删除成功")):a.$message.error(r.message)})}).catch(function(e){console.log(e)})},addUserBtn:function(){},addCreate:function(e,t){this.dialogVisible=!0,this.editCodeType=e,"add"==e?(this.menuTitle="新增权限",this.menuForm.menuName="",this.menuForm.menuCode="",this.menuForm.detail=""):"edit"==e&&(this.menuTitle="编辑权限",this.menuForm.menuName=t.permissionName,this.menuForm.menuCode=t.permissionCode,this.menuForm.detail=t.remark)},cancelCreate:function(){this.dialogVisible=!1,this.$refs.menuForm.clearValidate()},sureCreate:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var a={requestProject:t.requestProject,permissionName:t.menuForm.menuName,permissionCode:t.menuForm.menuCode,remark:t.menuForm.detail};"add"==t.editCodeType?Object(n.c)("/gic-authcenter/permission",a).then(function(e){var a=e.data;0==a.errorCode?(t.dialogVisible=!1,t.getList(),t.$message.success("保存成功")):t.$message.error(a.message)}).catch(function(e){console.log(e)}):"edit"==t.editCodeType&&(delete a.permissionCode,Object(n.d)("/gic-authcenter/permission/"+t.menuForm.menuCode,a).then(function(e){var a=e.data;0==a.errorCode?(t.dialogVisible=!1,t.getList(),t.$message.success("保存成功")):t.$message.error(a.message)}).catch(function(e){console.log(e)}))})}},components:{ywInput:r.a}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"my-right-content"},[r("div",{staticClass:"search-wrap clearfix"},[r("el-input",{staticClass:"fl",attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入内容",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchList(t)}},model:{value:e.searchInput,callback:function(t){e.searchInput=t},expression:"searchInput"}}),e._v(" "),r("el-button",{staticClass:"fr",attrs:{type:"primary"},on:{click:function(t){return e.addCreate("add")}}},[e._v("新增权限")])],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table-no-line-wrap",attrs:{data:e.tableData}},[r("el-table-column",{attrs:{prop:"permissionName",label:"权限名称","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"permissionCode",label:"权限code","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"remark",label:"说明","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.remark?t.row.remark:"--")+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"address",label:"操作日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("dateFormat")(t.row.updateTime,"YYYY-MM-DD hh:mm:ss"))+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"opr",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(a){return e.addCreate("edit",t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(a){return e.delAuthority(t.row,t.$index)}}},[e._v("删除")])]}}])}),e._v(" "),r("template",{slot:"empty"},[r("div",{staticClass:"no-data-wrap"},[r("div",{staticClass:"no-data-icon"},[r("img",{attrs:{src:a("8Td+"),alt:""}})]),e._v(" "),r("p",[e._v("暂无数据")])])])],2),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.totalCount>0,expression:"totalCount > 0"}],staticClass:"pagination"},[r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{title:e.menuTitle,visible:e.dialogVisible,width:"425px","before-close":e.cancelCreate},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"menuForm",attrs:{model:e.menuForm,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"权限名称",prop:"menuName"}},[r("yw-input",{attrs:{byteType:0,maxlength:20,placeholder:"最多20字"},model:{value:e.menuForm.menuName,callback:function(t){e.$set(e.menuForm,"menuName",t)},expression:"menuForm.menuName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"权限code",prop:"menuCode"}},[r("yw-input",{attrs:{disabled:"edit"==e.editCodeType,byteType:0,maxlength:32,placeholder:"英文、下划线、数字组成，最多32字"},model:{value:e.menuForm.menuCode,callback:function(t){e.$set(e.menuForm,"menuCode",t)},expression:"menuForm.menuCode"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"说明"}},[r("yw-input",{attrs:{type:"textarea",byteType:0,maxlength:200},model:{value:e.menuForm.detail,callback:function(t){e.$set(e.menuForm,"detail",t)},expression:"menuForm.detail"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelCreate}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sureCreate("menuForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("C7Lr")(l,u,!1,function(e){a("GGLC")},"data-v-4b61ccff",null);t.default=c.exports}});
//# sourceMappingURL=14.d67b9484828fa41f67fc.1560498375860.js.map